# 前端安全

## XSS 攻击（跨站脚本攻击）

>   英文全称：Cross Site Script，XSS 攻击，通常指黑客通过 HTML 注入篡改了网页，插入恶意脚本，从而在用户浏览网页时，控制用户浏览器的一种行为

### XSS 分类

#### 反射型 XSS

原理：反射型 XSS，也叫非持久型 XSS，是指发生请求时，XSS 代码出现在请求 URL 中，作为参数提交到服务器中，服务器解析并响应。响应结果中包含 XSS 代码，最后浏览器解析并执行

实现：攻击者通过给用户发送带有恶意脚本代码参数的 URL，当 URL 地址被打开时，特有的恶意代码参数被 HTML 解析、执行

![反射型xss](https://user-gold-cdn.xitu.io/2020/1/2/16f6538735685647?imageslim)

#### 存储型 XSS

原理：一般是攻击者输入的恶意代码存储在服务端，主要是将 XSS 代码发送到服务器（不管是数据库、内存还是文件系统），只要受害者浏览包含次恶意代码的网页就会执行恶意代码

实现：存储型 XSS 一般出现在网站浏览、评论、博客日志等交互处。例如：黑客提交了一条包含 XSS 代码的浏览到数据库。当目标用户查询浏览时，那些浏览的内容就会从服务器中解析出来并加载。浏览器发现有 XSS 代码，就当作正常的 HTML 和 JS 解析执行，XSS 攻击就发生了

### XSS 防御

1.  HttpOnly：浏览器禁止页面的 JavaScript 访问带有 HttpOnly 属性的 cookie
2.  输入检查（XSS Filter）：让一些基于特殊字符的攻击失效
3.  输出检查：在变量输出到 HTML 页面时，使用编码或转译的方式来防御 XSS 攻击



## CSRF（跨站请求伪造）

>   CSRF 就是利用你所在网站的登录的状态，以你的名义向网站发送恶意请求

### 实现方式

1.  用户登录受信任网站A，并在本地生成 cookie
2.  在不登出网站A的情况下，访问危险网站B

### CSRF 防御

1.  增加 token：在请求中放入攻击者所不能伪造的信息，并且该信息总不存在于 cookie 中。鉴于此，系统开发人员可以在 HTTP 请求中以参数的形式加入一个随机产生的 token，并在服务端进行 token 校验，如果请求中没有 token 或者 token 内容不正确，则认为是 CSRF 攻击而拒绝该请求
2.  通过 Referer 识别：根据 HTTP 协议，在 HTTP 头中有一个字段叫 Referer，它记录了当前请求的来源地址。通常情况下，访问一个安全受限的网页的请求都来自同一个网站
3.  增加验证码：重要操作增加验证码，避免用户在不知情的情况下构造了网络请求，青汁用户必须与应用进行交互



